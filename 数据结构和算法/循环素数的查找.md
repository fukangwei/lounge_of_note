---
title: 循环素数的查找
categories: 数据结构和算法
date: 2019-02-08 21:52:32
---
&emsp;&emsp;循环素数是一种特殊的素数，即对一个素数循环移位后仍然是素数。比如`1193`是个素数，对它循环移位后发现`1931`、`9311`、`3119`也都是素数，具有这样特征的数就是循环素数。<!--more-->
&emsp;&emsp;我们知道，素数是有无穷多个，但循环素数并不多，目前知道的最多只有`55`个。`100`以内的循环素数有`13`个，分别是`2`、`3`、`5`、`7`、`11`、`13`、`17`、`31`、`37`、`71`、`73`、`79`、`97`。`100`以内的循环素数相对比较好找，通过人工计算也可以轻松找到，但是`100`以上、甚至`1000`以上的循环素数就不是那么好找了，计算量将会非常大。不过，计算机给我们提供了方便，我们可以通过计算机编程来查找循环素数。
&emsp;&emsp;查找循环素数有两种方法：定义法和改进后的算法。

### 定义法

&emsp;&emsp;这种算法没有用到循环素数的特征，所有的数都在判断，所以有很多计算冗余。根据定义来判断，具体算法就是要找`N`以内的循环素数，就从`2`开始依次增加，判断这个数是否是素数。如果是素数，则对其循环移位后再判断，这个数有`M`位就需要移`M - 1`次，当然一旦发现移位后的数不是素数，就不需要再继续移位了，已经可以断定这个不是循环素数。当移位`M - 1`次后的数还是素数，那么这个素就是循环素数，当增加到`N`时就不需要再增加了，这样就可以得到`N`以内所有的循环素数。
&emsp;&emsp;因为这里用到了移位，所以就需要移位算法。首先假设这个数`N`有`M`位，用`N`对`10`取模就可以得到`N`的个位，用`N`除以`10`的结果再加上个位乘以`10`的`M - 1`次方就得到这个数的其中一个循环数，继续按照这个方法就可以得到其他循环数。算法如下：

``` cpp
u32Num = ( u32Num % 10 ) * Power ( u8CurLayer - 1, 10 ) + u32Num / 10;
```

其中`u8CurLayer`为数的位数`M`，`Power`是一个函数，用于求`10`的幂。

### 改进后的算法

&emsp;&emsp;改进的算法主要是运用了循环素数的特征，避免了原始算法判断所有数的缺点。循环素数里面任何一位都不可能是`0`、`2`、`4`、`5`、`6`、`8`这几个数字，假如数里面有这几个数字，那么当这几个数字移到个位上时要么能被`2`整除要么能被`5`整除，也就是说移位后就不是素数了，那么这个数就不是循环素数。因此算法的要点就是判断一个数是否是循环素数，先判断这个数是否包含数字`0`、`2`、`4`、`5`、`6`、`8`，如果有就不是循环素数，否则再按照原始算法判断是否是循环素数。这样就省去了很多判断素数的次数，算法的速度因此得以提高。
&emsp;&emsp;运行结果：用改进后的判断素数的算法结合查找循环素数的定义法，在计算机中计算了`50`个小时左右得到了结果，`9`位以内(即`10`亿以内)循环素数只有`55`个，其中`1`位有`4`组，即`4`个，`2`位有`5`组`9`个(因为`11`循环后还是`11`)，`3`位有`4`组`12`个，`4`位`2`组`8`个，`5`位`2`组`10`个，`6`位`2`组`12`个，`7`位、`8`位、`9`位循环素数不存在。代码如下(使用的是定义法)：

``` cpp
#include "stdio.h"
#include "math.h"

int is_prime ( int n ) { /* 判断是否是素数 */
    int flag = 1;
    int i = 0;

    for ( i = 2; i <= sqrt ( n ); i++ ) {
        if ( n % i == 0 ) {
            flag = 0;
            break;
        }
    }

    return flag;
}

int digit_num ( int num ) { /* 求出数字的位数 */
    int i = 1;

    for ( ;; ) {
        if ( num / ( int ) pow ( 10, i ) == 0 ) {
            return i;
        }

        i++;
    }
}

int crc_prime ( int n ) {
    int digit = 0; /* 保存数字的位数 */
    int i = 0;
    int crc_num = 0;
    int array_temp[10] = {0}; /* 缓存循环素数 */

    if ( is_prime ( n ) == 0 ) { /* 如果n不是素数，则返回0 */
        return 0;
    }

    digit = digit_num ( n );
    crc_num = n;

    while ( i < digit ) {
        crc_num = ( crc_num % 10 ) * pow ( 10, digit - 1 ) + crc_num / 10;

        if ( is_prime ( crc_num ) == 0 ) {
            return 0;
        }

        array_temp[i++] = crc_num;
    }

    for ( i = 0; i < digit; i++ ) { /* 打印循环素数 */
        printf ( "%d ", array_temp[i] );
    }

    printf ( "\n" );
    return 1;
}

int main ( void ) {
    int n = 0;
    int i = 0;
    int count = 0;
    printf ( "Please input the num: " );
    scanf ( "%d", &n ); /* 输入数字n */

    for ( i = 2; i <= n; i++ ) {
        if ( crc_prime ( i ) == 1 ) {
            count++;
        }
    }

    printf ( "the count is %d", count );
}
```