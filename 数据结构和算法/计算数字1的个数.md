---
title: 计算数字1的个数
categories: 数据结构和算法
date: 2019-02-09 13:49:58
---
&emsp;&emsp;给定一个十进制整数`N`，求出从`1`到`N`的所有整数中出现`1`的个数。例如`N = 2`时，`1 2`出现了`1`个`1`；`N = 12`时，`1 2 3 4 5 6 7 8 9 10 11 12`出现了`5`个`1`。<!--more-->
&emsp;&emsp;我们可以发现一些规律：`1`至`N`中`1`的个数跟最高位有关，那我们换个角度思考，给定一个`N`，我们分析`1`至`N`中的数在每一位上出现`1`的次数的和，看看每一位上`1`出现的个数的和由什么决定。
&emsp;&emsp;`1`位数的情况：大于等于`1`时有`1`个，小于`1`时就没有。
&emsp;&emsp;`2`位数的情况：`N = 13`时，个位数出现的`1`的次数为`2`，分别为`1`和`11`；十位数出现`1`的次数为`4`，分别为`10 11 12 13`，所以`f(N) = 2 + 4`。`N = 23`时，个位数出现的`1`的次数为`3`，分别为`1 11 21`；十位数出现`1`的次数为`10`，分别为`10`至`19`，所以`f(N) = 3 + 10`。
&emsp;&emsp;由此我们发现，个位数出现`1`的次数不仅和个位数有关，和十位数也有关。如果个位数大于等于`1`，则个位数出现`1`的次数为十位数的数字加`1`；如果个位数为`0`，个位数出现`1`的次数等于十位数数字。而十位数上出现`1`的次数也不仅和十位数相关，也和个位数相关：如果十位数字等于`1`，则十位数上出现`1`的次数为个位数的数字加`1`，假如十位数大于`1`，则十位数上出现`1`的次数为`10`。
&emsp;&emsp;`3`位数的情况：`N = 123`时，个位出现`1`的个数为`13`：`1 11 21 ... 91 101 111 121`；十位出现`1`的个数为`20`：`10`至`19`、`110`至`119`；百位出现`1`的个数为`24`：`100`至`123`。我们可以继续分析`4`位数，`5`位数，推导出下面一般的情况：
&emsp;&emsp;假设数字为`N`，我们要计算百位上出现`1`的次数，将由三部分决定：百位上的数字、百位以上的数字和百位一下的数字。
&emsp;&emsp;如果百位上的数字为`0`，则百位上出现`1`的次数仅由更高位决定。例如`12013`，百位出现`1`的情况为`100至199 1100至1199 2100至2199 ... 11100至11199`，共`1200`个，等于更高位数字乘以当前位数，即`12 * 100`。
&emsp;&emsp;如果百位上的数字大于`1`，则百位上出现`1`的次数仅由更高位决定。例如`12213`，百位出现`1`的情况为`100至199 1100至1199 2100至2199 ... 11100至11199 12100至12199`，共`1300`个，等于更高位数字加`1`乘以当前位数，即`(12 + 1) * 100`。
&emsp;&emsp;如果百位上的数字为`1`，则百位上出现`1`的次数不仅受更高位影响，还受低位影响。例如`12113`，受高位影响出现`1`的情况：`100至199 1100至1199 2100至2199 ... 11100至11199`，共`1200`个；但它还受低位影响，出现`1`的情况是`12100`至`12113`，共`114`个，等于低位数字`113 + 1`。

``` cpp
#include "stdio.h"

unsigned long int oneNumber ( unsigned long int n ) {
    long count = 0;
    long i = 1;
    long current = 0, after = 0, before = 0;

    while ( ( n / i ) != 0 ) {
        current = ( n / i ) % 10;
        before = n / ( i * 10 );
        after = n - ( n / i ) * i;

        if ( current > 1 ) {
            count = count + ( before + 1 ) * i;
        } else if ( current == 0 ) {
            count = count + before * i;
        } else if ( current == 1 ) {
            count = count + before * i + after + 1;
        }

        i = i * 10;
    }

    return count;
}

int main ( int argc, char *argv[] ) {
    unsigned long int iNumber = 0;
    unsigned long int uliCountNumber = 0;
    printf ( "请输入iNumber: " );
    scanf ( "%ld", &iNumber );
    uliCountNumber = oneNumber ( iNumber );
    printf ( "1~%d中1的个数为: %d\n", iNumber, uliCountNumber );
    return 0;
}
```