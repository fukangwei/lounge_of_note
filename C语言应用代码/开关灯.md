---
title: 开关灯
date: 2021-06-14 16:54:38
categories: C语言应用代码
---
&emsp;&emsp;一条长廊里依次装有`n`(`1 ≤ n ≤ 65535`)盏电灯，从头到尾编号`1、2、3、...、n - 1、n`。每盏电灯由一个拉线开关控制。开始，电灯全部关着。有`n`个学生从长廊穿过。第一个学生把号码凡是`1`的倍数的电灯的开关拉一下；接着第二个学生把号码凡是`2`的倍数的电灯的开关拉一下；接着第三个学生把号码凡是`3`的倍数的电灯的开关拉一下；如此继续下去，最后第`n`个学生把号码凡是`n`的倍数的电灯的开关拉一下。`n`个学生按此规定走完后，长廊里电灯有几盏亮着。<!--more-->
&emsp;&emsp;方案`1`如下：

``` cpp
#include "stdio.h"

int main ( int argc, char const *argv[] ) {
    unsigned int i, n, k;
    int sum = 0;
    char light[65535] = {0};
    printf ( "input n: " );
    scanf ( "%d", &n );

    for ( i = 0; i < n; i++ ) {
        for ( k = 0; k < 65535; k++ ) {
            if ( ( k + 1 ) % ( i + 1 ) == 0 ) {
                light[k] = !light[k];
            }
        }
    }

    for ( i = 0; i < 65535; i++ ) {
        if ( light[i] == 1 ) {
            sum++;
        }
    }

    printf ( "sum is %d\n", sum );
    return 0;
}
```

该代码的缺点是耗费的时间太长，输入`65535`后，运行了近`30`秒。
&emsp;&emsp;对于任何一盏灯，由于它原来不亮，那么当它的开关被按奇数次时，灯是开着的；当它的开关被按偶数次时，灯是关着的；一盏灯的开关被按的次数，恰等于这盏灯编号的因数的个数。要求哪些灯还亮着，就是问哪些灯编号的因数有奇数个，显然完全平方数有奇数个因数。每个数除以一个数`A`等于另一个数`B`，那么`A`和`B`都是它的因数，于是因数是成对出现的。但要求因数是奇数个，就必须使两个因数相等，即`A = B`。综上所述这道题就是找`1`至`65535`中完全平方数的个数，只有编号为`1`、`4`、`9`、`16`、`25`等编号的电灯最后是亮着的。方案`2`如下：

``` cpp
#include <stdio.h>

int main ( int argc, char *argv[] ) {
    unsigned int n;

    while ( scanf ( "%d", &n ) == 1 ) {
        int ans = 0;

        for ( unsigned int i = 1;; ++i ) {
            if ( i * i > n ) {
                break;
            }

            ++ans;
        }

        printf ( "%d\n", ans );
    }

    return 0;
}
```